<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NOTHING - Single Page Game Hub</title>
    
    <script>
        // --- START: INITIAL SETUP & CLOAKING ---
        const savedTheme = localStorage.getItem('hubTheme');
        const currentTheme = savedTheme ? savedTheme : 'rainbow';
        document.documentElement.className = `theme-${currentTheme}`;

        const savedFavicon = localStorage.getItem('hubFavicon');
        const savedTitle = localStorage.getItem('hubTitle');
        const defaultTitle = 'NOTHING - Single Page Game Hub';
        const faviconUrl = savedFavicon 
            ? savedFavicon 
            : "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üêª</text></svg>";
        
        const ORIGINAL_TITLE = savedTitle ? savedTitle : defaultTitle;
        document.title = ORIGINAL_TITLE;
        
        let link = document.querySelector("link[rel~='icon']");
        if (!link) {
            link = document.createElement('link');
            link.rel = 'icon';
            document.getElementsByTagName('head')[0].appendChild(link);
        }
        link.href = faviconUrl;
        
        function panicHide() {
            window.location.replace("https://www.wikipedia.org/");
        }
        
        function openAboutBlank() {
            const currentUrl = window.location.href;
            const blank = window.open('about:blank', '_blank');
            if (blank) {
                blank.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>${document.title}</title>
                        <style>body { margin: 0; overflow: hidden; } iframe { border: none; width: 100vw; height: 100vh; }</style>
                    </head>
                    <body>
                        <iframe src="${currentUrl}"></iframe>
                    </body>
                    </html>
                `);
                blank.document.close();
            }
        }

        const NOTIFICATION_CLOAK_ENABLED = localStorage.getItem('notificationCloakEnabled') === 'true';
        const CLOAKED_TITLE = '(1) Message Student/Portal';
        
        function applyCloak() {
            if (NOTIFICATION_CLOAK_ENABLED) { document.title = CLOAKED_TITLE; }
        }

        function removeCloak() {
            if (NOTIFICATION_CLOAK_ENABLED) { document.title = ORIGINAL_TITLE; }
        }

        if (NOTIFICATION_CLOAK_ENABLED) {
            window.addEventListener('blur', applyCloak); 
            window.addEventListener('focus', removeCloak);
        }
        // --- END: INITIAL SETUP & CLOAKING ---


        // --- START: LOADER MESSAGE AND COUNTDOWN LOGIC ---
        function initializeLoader() {
            const loaderScreen = document.getElementById('loading-screen');
            const loaderText = document.getElementById('loader-text');
            const countdownSpan = document.getElementById('countdown-span');
            const shouldShowLoader = localStorage.getItem('showCustomLoader') === 'true';

            if (!shouldShowLoader || !loaderScreen) {
                if (loaderScreen) {
                    loaderScreen.style.display = 'none';
                }
                return; 
            }

            localStorage.removeItem('showCustomLoader');
            const customMessage = localStorage.getItem('hubLoaderMessage') || 'Loading Game Hub';
            loaderText.textContent = customMessage;
            
            let count = 3; 
            countdownSpan.textContent = count; 

            const timer = setInterval(() => {
                count--;
                countdownSpan.textContent = count;

                if (count <= 0) {
                    clearInterval(timer);
                    countdownSpan.style.display = 'none'; 
                    loaderText.textContent = 'Launching!';

                    setTimeout(() => {
                        if (loaderScreen) {
                            loaderScreen.classList.add('loader-hidden');
                        }
                    }, 500); 
                }
            }, 1000);
        }
        // --- END: LOADER MESSAGE AND COUNTDOWN LOGIC ---

        // --- START: SPOTLIGHT LOADER LOGIC ---
        function initializeSpotlight() {
            const spotlightTitle = localStorage.getItem('hubSpotlightTitle');
            const spotlightLink = localStorage.getItem('hubSpotlightLink');
            const spotlightImage = localStorage.getItem('hubSpotlightImage');
            
            const spotlightElement = document.getElementById('daily-spotlight');
            const titleElement = document.getElementById('spotlight-title');
            const buttonElement = document.getElementById('spotlight-button');

            if (spotlightElement) {
                if (spotlightImage) {
                    spotlightElement.style.backgroundImage = `linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url('${spotlightImage}')`;
                } else {
                    spotlightElement.style.backgroundColor = 'var(--accent-color)';
                }

                titleElement.textContent = spotlightTitle || 'Featured Game of the Day!';
                buttonElement.href = spotlightLink || '#';
            }
        }
        // --- END: SPOTLIGHT LOADER LOGIC ---
        
        document.addEventListener('DOMContentLoaded', () => {
            initializeLoader();
            initializeSpotlight();
        });

    </script>

    <style>
        /* CSS Keyframes for the Never-Ending Rainbow Background */
        @keyframes rainbow-glow {
            0% { background-color: #ff0000; } 16% { background-color: #ff7f00; } 
            33% { background-color: #ffff00; } 50% { background-color: #00ff00; } 
            66% { background-color: #0000ff; } 83% { background-color: #4b0082; } 
            100% { background-color: #ff0000; } 
        }
        
        :root {
            --dark-bg: #1a1a1a;
            --blue-bg: #007bff;
            --purple-bg: #6f42c1;
            --accent-color: #ff5722;
        }

        /* --- CORE STYLES & FIXES --- */
        html { height: 100%; }
        
        body {
            font-family: sans-serif;
            margin: 0;
            color: #fff;
            min-height: 100%; 
            background-color: var(--dark-bg); 
            background-repeat: no-repeat; 
            background-attachment: fixed; 
        }

        .theme-rainbow body { animation: rainbow-glow 10s infinite linear; }
        .theme-dark body { background-color: var(--dark-bg); animation: none; }
        .theme-blue body { background-color: var(--blue-bg); animation: none; }
        .theme-purple body { background-color: var(--purple-bg); animation: none; }

        /* --- LOADER SCREEN STYLES --- */
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background-color: var(--dark-bg); z-index: 9999; display: flex;
            flex-direction: column; justify-content: center; align-items: center;
            opacity: 1; transition: opacity 1s ease-out; 
        }
        #loader-text { font-size: 3em; font-weight: bold; color: var(--accent-color); margin-bottom: 20px; }
        #countdown-span { font-size: 5em; font-weight: bold; color: #ccc; }
        .loader-hidden { opacity: 0 !important; pointer-events: none; }
        
        /* --- DAILY SPOTLIGHT STYLES --- */
        #daily-spotlight {
            width: 90%; max-width: 1000px; margin: 20px auto 0; height: 180px; 
            border-radius: 12px; background-color: #333; background-size: cover;
            background-position: center; background-repeat: no-repeat;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); display: flex;
            align-items: flex-end; position: relative; overflow: hidden;
            transition: background-color 0.5s;
        }
        #spotlight-content {
            width: 100%; background: rgba(0, 0, 0, 0.7); padding: 15px 20px;
            display: flex; justify-content: space-between; align-items: center;
        }
        #spotlight-title { margin: 0; color: white; font-size: 1.5em; border-bottom: none; padding-bottom: 0; }
        #spotlight-button {
            text-decoration: none; background-color: var(--accent-color); 
            color: white; padding: 10px 20px; border-radius: 8px;
            font-weight: bold; transition: background-color 0.2s;
        }
        #spotlight-button:hover { background-color: #ff9800; }
        
        /* --- HUB GENERAL STYLES --- */
        header { padding: 30px 20px 20px; background-color: rgba(44, 44, 44, 0.9); text-align: center; backdrop-filter: blur(5px); position: relative
